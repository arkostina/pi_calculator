# Pi Calculator with Celery and Flask

This application calculates Pi to a specified number of decimal places using Celery for asynchronous task processing.

## Prerequisites

- Docker
- Docker Compose

## Usage

1.  **Clone the repository:**

    ```bash
    git clone https://github.com/arkostina/pi_calculator.git
    cd pi_calculator
    ```

2.  **Build and Run:**

    ```bash
    docker compose up --build
    ```

    Services started:
    - **Redis** – broker and backend for Celery
    - **Flask API** – running on port 5000
    - **Celery worker** – consumes tasks

3.  **API Endpoints:**

    -   `/calculate_pi?n=<number_of_digits>`:  Starts a Pi calculation task.  Returns a `task_id`.
    
    -   `/check_progress?task_id=<task_id>`:  Checks the status of a task.  Returns a JSON object with `state`, `progress`, and `result`.

4. **Example `curl`**:

    > If the output of the following curl commands doesn’t start on a new line, append `-w "\n"` to the commands to ensure a newline is printed after the response.
    
    **1. Start calculation for 50 digits:**
        
    ```bash
    curl "http://localhost:5000/calculate_pi?n=50"
    ```
    **Response:**
    ```bash
    {"task_id":"12345678-90ab-cdef-1234-567890abcdef"}
    ```
     
    **2. Check progress:** 
    ```bash
    curl "http://localhost:5000/check_progress/12345678-90ab-cdef-1234-567890abcdef"
    ```
    **Response (in progress):**
    ```bash
    {
        "state": "PROGRESS",
        "progress": 0.34,
        "result": null
    }
    ```

    **Response (finished):**
    ```bash
    {
        "state": "FINISHED",
        "progress": 1.0,
        "result": "3.14159265358979323846264338327950288419716939937510"
    }

    ```


## API Documentation

The API documentation is automatically generated by FastAPI and can be accessed at:

`http://localhost:5000/docs`

after the application is running.